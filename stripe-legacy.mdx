---
title: "Payments (Legacy)"
description: "Legacy Stripe integration for collecting payments"
version: "1.0"
legacy: true
---
<warn>
This is a legacy article referencing former functionality being sunset in favor of a new version.
</warn>

<Note>
  **Legacy Version**: This is the legacy Stripe integration. For the latest version, see [Payments v2](/stripe-v2).
</Note>

Stripe enables you to set up payments for your application, allowing you to charge users for access or premium features.

Our integration streamlines the setup process in minutes, providing:

- **Simple Setup**: No need to configure API keys or webhooks manually
- **Automatic Authentication**: We handle all the technical details behind the scenes
- **Familiar Interface**: Works just like the standard Stripe package you might be familiar with
- **Polling-Based**: Uses a simple polling approach instead of complex webhooks

## How It Works

Think of our Stripe integration like having a personal assistant who handles all the complicated payment setup for you. Here's what happens:

### 1. **The Proxy System**
When you use Stripe in your app, we act as a "middleman" between your code and Stripe's servers. This means:
- Your code looks and feels like it's using Stripe directly
- We automatically add your authentication details
- We handle all the security and connection details
- You don't need to manage API keys or secrets

### 2. **Automatic Authentication**
Every time your app makes a payment request, we automatically:
- Add your organization's Stripe account details
- Include the right security tokens
- Handle connected account setup
- Manage user context and permissions

### 3. **Polling Instead of Webhooks**
Instead of using complex webhook systems, we use a simpler "polling" approach:
- Your app checks Stripe's servers periodically for payment status
- When a payment completes, your app updates its own database
- This is more reliable and easier to debug than webhooks

## Setting Up Payments

### Step 1: Connect Your Stripe Account
1. Go to your Create dashboard
2. Navigate to "Accept Payments" section
3. Click "Connect with Stripe"
4. Follow the onboarding process to link your business account

### Step 2: Tell the Agent What You Want
Simply ask the agent to "add Stripe payments" to your app. You can specify:
- **Subscription payments**: Monthly/yearly recurring charges
- **One-time payments**: Single purchases or tips
- **Custom amounts**: Let users choose how much to pay
- **Product-specific pricing**: Different prices for different features

Example prompts:
- "Add a $9.99/month subscription to my app"
- "Create a one-time payment option for premium features"
- "Set up a tip jar where users can pay what they want"

### Step 3: The Agent Creates Your Payment System
The agent will automatically:
- Create the necessary payment pages
- Set up checkout sessions
- Add polling logic to check payment status
- Update your database when payments complete
- Handle error cases and edge scenarios

## How Payments Work in Your App

### For Subscriptions
1. **User clicks "Subscribe"** → Redirected to Stripe checkout
2. **User completes payment** → Stripe processes the payment
3. **Your app polls for status** → Checks if payment was successful
4. **Database updates** → User's subscription status is updated
5. **User gets access** → Premium features are unlocked

### For One-Time Payments
1. **User clicks "Buy"** → Redirected to Stripe checkout
2. **User completes payment** → Stripe processes the payment
3. **Your app polls for status** → Checks if payment was successful
4. **Database updates** → Purchase is recorded
5. **User gets access** → Feature or product is unlocked

## Debugging Common Issues

### "Payment not showing up in my app"
**What to tell the agent:**
- "The payment completed on Stripe but my app isn't recognizing it"
- "Users are paying but not getting access to premium features"

**Likely causes:**
- Polling logic isn't checking frequently enough
- Database update logic has an error
- Payment status check is looking for wrong criteria

### "Users can't complete payments"
**What to tell the agent:**
- "Users are getting errors when trying to pay"
- "The checkout page isn't loading properly"

**Likely causes:**
- Stripe account not properly connected
- Product/price setup issues
- Redirect URLs configured incorrectly

### "Payments are being charged twice"
**What to tell the agent:**
- "Users are being charged multiple times for the same purchase"
- "Duplicate payments are appearing in Stripe"

**Likely causes:**
- Polling logic running too frequently
- Missing duplicate payment checks
- Race conditions in payment processing

### "Subscription status is wrong"
**What to tell the agent:**
- "Users are still being charged after canceling"
- "Subscription status doesn't match Stripe dashboard"

**Likely causes:**
- Database not syncing with Stripe properly
- Cancellation logic not implemented
- Status polling not checking all subscription states

## What the Agent Creates

When you ask for Stripe integration, the agent typically creates:

### 1. **Checkout Function**
- Creates Stripe checkout sessions
- Handles redirect to Stripe's payment page
- Manages success/cancel URLs

### 2. **Payment Status Checker**
- Polls Stripe for payment status
- Updates your database when payments complete
- Handles different payment states

### 3. **Subscription Management**
- Checks subscription status
- Handles cancellations and updates
- Syncs with your user database

### 4. **Payment Pages**
- Subscription signup page
- Payment confirmation page
- Account management page

## Best Practices

### 1. **Test Everything**
- Always test payments in Stripe's test mode first
- Verify that your app correctly recognizes completed payments
- Test both successful and failed payment scenarios

### 2. **Monitor Your Payments**
- Check your Stripe dashboard regularly
- Monitor for failed payments or errors
- Keep track of subscription status

### 3. **Handle Edge Cases**
- What happens if a user closes the browser during payment?
- How do you handle network errors during polling?
- What if Stripe is temporarily unavailable?

### 4. **User Experience**
- Provide clear feedback during payment processing
- Show loading states while checking payment status
- Give users a way to retry failed payments

## Troubleshooting Checklist

When payments aren't working, check these in order:

1. **Stripe Connection**: Is your Stripe account properly connected?
2. **Product Setup**: Are your products and prices configured in Stripe?
3. **Checkout Flow**: Does the checkout page load and redirect properly?
4. **Payment Processing**: Do payments complete successfully in Stripe?
5. **Status Polling**: Is your app checking for payment status?
6. **Database Updates**: Are completed payments being recorded?
7. **Access Control**: Are users getting access after payment?

## Getting Help

If you're having issues with payments:

1. **Check the logs**: Look for error messages in your app's console
2. **Verify Stripe dashboard**: Confirm payments are being processed
3. **Test the flow**: Try making a test payment yourself
4. **Ask the agent**: Describe the specific issue you're seeing

Remember: The agent can help debug and fix most payment issues. Just describe what's happening and what you expect to happen instead.

## Migration to v2

If you're upgrading to the new Stripe integration:

- **No manual migration needed**: The agent will handle the transition
- **Existing payments continue**: Current subscriptions and customers are preserved
- **Improved reliability**: The new polling approach is more robust
- **Simplified maintenance**: Less configuration and setup required

The new version is designed to be a drop-in replacement that's easier to use and more reliable than the legacy system.

---

**Note**: This legacy version is being sunset in favor of the new Stripe v2 integration. For the latest features and improvements, please use [Payments v2](/stripe-v2).
